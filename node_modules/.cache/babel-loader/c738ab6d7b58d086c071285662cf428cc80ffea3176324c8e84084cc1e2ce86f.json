{"ast":null,"code":"// src/utils/dropdownProvider.js\nimport { fetchMasterData } from './moduleMasterAPI'; // NOTE: exact filename + casing!\n\nfunction getDump(module) {\n  const raw = sessionStorage.getItem(`dump_${module}`);\n  if (!raw) return null;\n  try {\n    const parsed = JSON.parse(raw);\n    // unwrap { data, timestamp } if present\n    return parsed && parsed.data ? parsed.data : parsed;\n  } catch {\n    return null;\n  }\n}\nexport async function getOptionsFromModuleSource(source) {\n  var _dump;\n  const [module, prop] = String(source).split('.');\n  console.debug('[dropdownProvider] called with source:', source, '→ module:', module, 'prop:', prop);\n  if (!module || !prop) {\n    console.warn('[dropdownProvider] Bad source:', source);\n    return [];\n  }\n\n  // 1) try cache\n  let dump = getDump(module);\n  console.debug('[dropdownProvider] cache hit?', !!dump);\n\n  // 2) fetch if not cached\n  if (!dump) {\n    console.debug('[dropdownProvider] fetching dump for module:', module);\n    dump = await fetchMasterData(module); // expected: { headers, rows, totalRecords }\n    sessionStorage.setItem(`dump_${module}`, JSON.stringify(dump));\n  }\n  const rows = ((_dump = dump) === null || _dump === void 0 ? void 0 : _dump.rows) || [];\n  console.debug('[dropdownProvider] rows length:', rows.length);\n  if (rows[0]) console.debug('[dropdownProvider] first row keys:', Object.keys(rows[0]));\n  const uniq = new Set();\n  for (const r of rows) {\n    const v = r === null || r === void 0 ? void 0 : r[prop];\n    if (v !== undefined && v !== null && `${v}`.trim() !== '') uniq.add(String(v));\n  }\n  const out = Array.from(uniq).sort((a, b) => a.localeCompare(b));\n  console.debug('[dropdownProvider] options built:', out.length, out.slice(0, 5));\n  return out;\n}","map":{"version":3,"names":["fetchMasterData","getDump","module","raw","sessionStorage","getItem","parsed","JSON","parse","data","getOptionsFromModuleSource","source","_dump","prop","String","split","console","debug","warn","dump","setItem","stringify","rows","length","Object","keys","uniq","Set","r","v","undefined","trim","add","out","Array","from","sort","a","b","localeCompare","slice"],"sources":["/Users/abhilash/Downloads/jp-internal-app/src/utils/dropdownProvider.js"],"sourcesContent":["// src/utils/dropdownProvider.js\nimport { fetchMasterData } from './moduleMasterAPI'; // NOTE: exact filename + casing!\n\nfunction getDump(module) {\n  const raw = sessionStorage.getItem(`dump_${module}`);\n  if (!raw) return null;\n  try { const parsed = JSON.parse(raw);\n    // unwrap { data, timestamp } if present\n    return parsed && parsed.data ? parsed.data : parsed; } catch { return null; }\n}\n\nexport async function getOptionsFromModuleSource(source) {\n  const [module, prop] = String(source).split('.');\n  console.debug('[dropdownProvider] called with source:', source, '→ module:', module, 'prop:', prop);\n\n  if (!module || !prop) {\n    console.warn('[dropdownProvider] Bad source:', source);\n    return [];\n  }\n\n  // 1) try cache\n  let dump = getDump(module);\n  console.debug('[dropdownProvider] cache hit?', !!dump);\n\n  // 2) fetch if not cached\n  if (!dump) {\n    console.debug('[dropdownProvider] fetching dump for module:', module);\n    dump = await fetchMasterData(module); // expected: { headers, rows, totalRecords }\n    sessionStorage.setItem(`dump_${module}`, JSON.stringify(dump));\n  }\n\n  const rows = dump?.rows || [];\n  console.debug('[dropdownProvider] rows length:', rows.length);\n  if (rows[0]) console.debug('[dropdownProvider] first row keys:', Object.keys(rows[0]));\n\n  const uniq = new Set();\n  for (const r of rows) {\n    const v = r?.[prop];\n    if (v !== undefined && v !== null && `${v}`.trim() !== '') uniq.add(String(v));\n  }\n\n  const out = Array.from(uniq).sort((a, b) => a.localeCompare(b));\n  console.debug('[dropdownProvider] options built:', out.length, out.slice(0, 5));\n  return out;\n}\n"],"mappings":"AAAA;AACA,SAASA,eAAe,QAAQ,mBAAmB,CAAC,CAAC;;AAErD,SAASC,OAAOA,CAACC,MAAM,EAAE;EACvB,MAAMC,GAAG,GAAGC,cAAc,CAACC,OAAO,CAAC,QAAQH,MAAM,EAAE,CAAC;EACpD,IAAI,CAACC,GAAG,EAAE,OAAO,IAAI;EACrB,IAAI;IAAE,MAAMG,MAAM,GAAGC,IAAI,CAACC,KAAK,CAACL,GAAG,CAAC;IAClC;IACA,OAAOG,MAAM,IAAIA,MAAM,CAACG,IAAI,GAAGH,MAAM,CAACG,IAAI,GAAGH,MAAM;EAAE,CAAC,CAAC,MAAM;IAAE,OAAO,IAAI;EAAE;AAChF;AAEA,OAAO,eAAeI,0BAA0BA,CAACC,MAAM,EAAE;EAAA,IAAAC,KAAA;EACvD,MAAM,CAACV,MAAM,EAAEW,IAAI,CAAC,GAAGC,MAAM,CAACH,MAAM,CAAC,CAACI,KAAK,CAAC,GAAG,CAAC;EAChDC,OAAO,CAACC,KAAK,CAAC,wCAAwC,EAAEN,MAAM,EAAE,WAAW,EAAET,MAAM,EAAE,OAAO,EAAEW,IAAI,CAAC;EAEnG,IAAI,CAACX,MAAM,IAAI,CAACW,IAAI,EAAE;IACpBG,OAAO,CAACE,IAAI,CAAC,gCAAgC,EAAEP,MAAM,CAAC;IACtD,OAAO,EAAE;EACX;;EAEA;EACA,IAAIQ,IAAI,GAAGlB,OAAO,CAACC,MAAM,CAAC;EAC1Bc,OAAO,CAACC,KAAK,CAAC,+BAA+B,EAAE,CAAC,CAACE,IAAI,CAAC;;EAEtD;EACA,IAAI,CAACA,IAAI,EAAE;IACTH,OAAO,CAACC,KAAK,CAAC,8CAA8C,EAAEf,MAAM,CAAC;IACrEiB,IAAI,GAAG,MAAMnB,eAAe,CAACE,MAAM,CAAC,CAAC,CAAC;IACtCE,cAAc,CAACgB,OAAO,CAAC,QAAQlB,MAAM,EAAE,EAAEK,IAAI,CAACc,SAAS,CAACF,IAAI,CAAC,CAAC;EAChE;EAEA,MAAMG,IAAI,GAAG,EAAAV,KAAA,GAAAO,IAAI,cAAAP,KAAA,uBAAJA,KAAA,CAAMU,IAAI,KAAI,EAAE;EAC7BN,OAAO,CAACC,KAAK,CAAC,iCAAiC,EAAEK,IAAI,CAACC,MAAM,CAAC;EAC7D,IAAID,IAAI,CAAC,CAAC,CAAC,EAAEN,OAAO,CAACC,KAAK,CAAC,oCAAoC,EAAEO,MAAM,CAACC,IAAI,CAACH,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;EAEtF,MAAMI,IAAI,GAAG,IAAIC,GAAG,CAAC,CAAC;EACtB,KAAK,MAAMC,CAAC,IAAIN,IAAI,EAAE;IACpB,MAAMO,CAAC,GAAGD,CAAC,aAADA,CAAC,uBAADA,CAAC,CAAGf,IAAI,CAAC;IACnB,IAAIgB,CAAC,KAAKC,SAAS,IAAID,CAAC,KAAK,IAAI,IAAI,GAAGA,CAAC,EAAE,CAACE,IAAI,CAAC,CAAC,KAAK,EAAE,EAAEL,IAAI,CAACM,GAAG,CAAClB,MAAM,CAACe,CAAC,CAAC,CAAC;EAChF;EAEA,MAAMI,GAAG,GAAGC,KAAK,CAACC,IAAI,CAACT,IAAI,CAAC,CAACU,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKD,CAAC,CAACE,aAAa,CAACD,CAAC,CAAC,CAAC;EAC/DtB,OAAO,CAACC,KAAK,CAAC,mCAAmC,EAAEgB,GAAG,CAACV,MAAM,EAAEU,GAAG,CAACO,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;EAC/E,OAAOP,GAAG;AACZ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}